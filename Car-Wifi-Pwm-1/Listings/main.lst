C51 COMPILER V9.00   MAIN                                                                  02/12/2017 22:46:46 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\Keil5 C51\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\ma
                    -in.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <stc89c52.h>
   2          #include <string.h>
   3          
   4          sbit key1=P3^4;
   5          sbit key2=P3^5;
   6          sbit key3=P3^6;
   7          sbit key4=P3^7;
   8          
   9          unsigned int xdata num[7];
  10          unsigned int display_ctr=0;             // æ•°ç ç®¡æ˜¾ç¤ºå¾ªç¯æ§åˆ¶
  11          unsigned int sending=0,new_signal=0;    //sendingç”¨äºç¼“è§£ä¸²å£æ•°æ®å‘é€è¾ƒæ…¢çš„æƒ…å†µ,new_signalç”¨ä
             -ºåˆ¤æ–­æ˜¯å¦æœ‰æ–°æ•°æ®è¿›å…¥
  12          unsigned int sign=0;
  13          unsigned char Action_Buff='q';
  14          
  15          #include"digital_led.h"     //è°ƒç”¨æ•°ç ç®¡éƒ¨åˆ†
*** WARNING C280 IN LINE 23 OF CAR_ACTION.H: 'L_oriention': unreferenced local variable
*** WARNING C280 IN LINE 23 OF CAR_ACTION.H: 'R_oriention': unreferenced local variable
  16          extern struct Queue RBuff;     //digital_led.h
  17          extern void InitQueue(struct Queue *Q);     //å¾ªç¯é˜Ÿåˆ—åˆå§‹åŒ–
  18          extern unsigned char SerQueue(struct Queue *Q,int r);           // rä¸ºæ‰€è¦æŸ¥æ‰¾çš„å½“å‰ä½ç½®
  19          extern void char_to_int();              //å­—ç¬¦è½¬æ•´å‹æ•°å­—å¹¶è¾“å‡º
  20          
  21          #include"ESP8266.h"
  22          extern void Init_ESP8266();
  23          
  24          #include"car_action.h"
  25          extern int Lgear,Rgear;
  26          
  27          struct Queue RBuff;     //Rbuffæ˜¯ä¸€ä¸ªé™æ€å¾ªç¯é˜Ÿåˆ—/å­—ç¬¦æ•°ç»„
  28          
  29          //------------Chipåˆå§‹åŒ–-----------------
  30          void Init()
  31          {
  32   1              //AUXR &= 0xFB;         //å®šæ—¶å™¨2æ—¶é’Ÿä¸ºFosc/12,å³12T,T2åœ¨é¢„åˆ†é¢‘ç¦æ­¢æ—¶é»˜è®¤ä¸º12åˆ†é¢‘
  33   1              //AUXR |= 0x01;         //ä¸²å£1é€‰æ‹©å®šæ—¶å™¨2ä¸ºæ³¢ç‰¹ç‡å‘ç”Ÿå™¨,å·²ç»åœ¨T2CONè®¾ç½®R/TCLK
  34   1      
  35   1              RCAP2H = 0xff;  //T2é«˜8ä½é‡è½½å€¼
  36   1              RCAP2L = 0xdc;  //T2ä½8ä½é‡è½½å€¼
  37   1              TH2 = RCAP2H;   //T2åˆå€¼
  38   1              TL2 = RCAP2L;   //T2åˆå€¼     
  39   1                      
  40   1              PCON = 0;       //æ³¢ç‰¹ç‡ä¸åŠ å€    
  41   1              T2CON = 0x34;   //T2æ§åˆ¶è®¾ç½®,åœ¨R/TCLKç¡®å®šT2ä½œä¸ºä¸²å£æ³¢ç‰¹ç‡äº§ç”Ÿå™¨ TF2 EXF2 (RCLK) (TCLK) EXE
             -N2 (TR2) C/T2 CP/RL2
  42   1              T2MOD = 0x01;   //T2æ¨¡å¼è®¾ç½®, D7 D6 D5 D4 D3 D2 T2OE(è¾“å‡ºåˆ°P1.0) DCEN(å‘ä¸‹è®¡æ•°å…è®¸)
  43   1              SCON = 0x50;        //ä¸²å£å·¥ä½œæ–¹å¼1,8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡
  44   1              REN = 1;        //å¯ç”¨ä¸²å£æ¥æ”¶
  45   1      
  46   1              /*----------------Timer0/1æ¨¡å¼è®¾ç½®----------------------------*/
  47   1              TMOD = 0x11;    //å®šæ—¶å™¨1/0,å·¥ä½œæ¨¡å¼1(16ä½æ‰‹åŠ¨)
  48   1      
  49   1              /*--------------------Timer1--------------------------------*/
  50   1              TH1=(65536-46080)/256;          //æ‰€è®°æ¬¡æ•°åº”ä¸º46080,è®¡æ—¶å™¨æ¯éš”50000uså³50mså‘èµ·ä¸€æ¬¡ä¸­æ–­
C51 COMPILER V9.00   MAIN                                                                  02/12/2017 22:46:46 PAGE 2   

  51   1              TL1=(65536-46080)%256;          //46080=50000*11.0592/12
  52   1              TR1 = 1;        //æ‰“å¼€å®šæ—¶å™¨1
  53   1      
  54   1              /*--------------------Timer0--------------------------------*/
  55   1              TH0=(65536-46080)/256;          //æ‰€è®°æ¬¡æ•°åº”ä¸º46080,è®¡æ—¶å™¨æ¯éš”50000uså³50mså‘èµ·ä¸€æ¬¡ä¸­æ–­
  56   1              TL0=(65536-46080)%256;          //46080=50000*11.0592/12
  57   1              TR0 = 1;        //æ‰“å¼€å®šæ—¶å™¨0
  58   1      
  59   1              /*-------------------interrupt_control----------------------*/
  60   1              ES = 0;//å…ˆå…³é—­ä¸²å£ä¸­æ–­,WIFIæ¨¡å—åˆå§‹åŒ–åå†æ‰“å¼€
  61   1              TI = 0;//ä¸²å£è¾“å‡ºä¸­æ–­éœ€å…ˆç½®0é¿å…å¼•èµ·å†²çª
  62   1              EA = 1;//å¼€å¯æ€»ä¸­æ–­
  63   1      }
  64          
  65          void main(void)
  66          {
  67   1              Init();
  68   1              Delayms(2000);
  69   1              //Init_ESP8266();
  70   1              TI = 1;
  71   1              ES=1;
  72   1              P1=0x00;
  73   1              InitQueue(&RBuff);
  74   1              while(1)  //ä¸è®©ä¸»å‡½æ•°å¾ªç¯æ‰§è¡Œå¹¶ä¸”å¾ªç¯æ£€æµ‹ï¼ˆæŸ¥è¯¢æ–¹å¼ï¼‰
  75   1              {
  76   2                      if(SBUF== '@' && new_signal)    //if(SerQueue(&RBuff,RBuff.rear) == '@' && new_signal)
  77   2                      {
  78   3                              char_to_int();
  79   3                      }
  80   2                      if(key1 == 0)
  81   2                      {
  82   3                              P1=0x00;
  83   3                              Init_ESP8266();
  84   3                              //P1=0xff;
  85   3                      }
  86   2                      if(key3 == 0)
  87   2                      {
  88   3                              if(Lgear==(gear+1))
  89   3                                      Lgear=1;
  90   3                              else 
  91   3                              {
  92   4                                      Lgear++;
  93   4                                      Status_display(Lgear);
  94   4                              }
  95   3                      }
  96   2                      if(key4 == 0)
  97   2                      {
  98   3                              if(Rgear==(gear+1))
  99   3                                      Rgear=1;
 100   3                              else
 101   3                              {
 102   4                                      Rgear++;
 103   4                                      Status_display(Rgear);
 104   4                              }
 105   3                      }
 106   2              }
 107   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1682    ----
   CONSTANT SIZE    =    102    ----
C51 COMPILER V9.00   MAIN                                                                  02/12/2017 22:46:46 PAGE 3   

   XDATA SIZE       =     56    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     43      45
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
